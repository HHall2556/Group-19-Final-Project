"use strict";const versionPW="1.1",HOUR_SECONDS=36e5,DAY_SECONDS=864e5,PAGE_ID=uuidv4(),expiryStorage={getItem(e){const t=expiryStorage.getJSON(e);return t?this.isExpire(t)?(localStorage.removeItem(e),null):t:null},getItemValue(e){const t=expiryStorage.getItem(e);return t?t.value:null},getItemExpires(e){const t=expiryStorage.getItem(e);return t?t.expires:null},setItem(e,t,i){const n={value:t,expires:(new Date).getTime()+i};expiryStorage.setJSON(e,n)},updateItemValue(e,t){const i=expiryStorage.getJSON(e);return!!i&&(i.value=t,expiryStorage.setJSON(e,i),!0)},updateItemExpires(e,t){const i=expiryStorage.getJSON(e);return!!i&&(i.expires=t,expiryStorage.setJSON(e,i),!0)},getJSON(e){const t=localStorage.getItem(e);return t?JSONParseSafe(t):null},setJSON:(e,t)=>localStorage.setItem(e,JSON.stringify(t)),isExpire:e=>(new Date).getTime()>e.expires,garbageCollector(e,t=36e5){setTimeout((()=>{Object.keys(localStorage).forEach((t=>{0===t.indexOf(e)&&this.getItem(t)})),this.garbageCollector(e,t)}),t)}},caps={key:{getSkip:(e,t,i)=>caps.key.make("hb","skc",e,t,i,"s"),getRepeat:(e,t,i)=>caps.key.make("hb","skc",e,t,i,"r"),getCap:(e,t,i)=>caps.key.make("hb","skc",e,t,i,"c"),getBidderCap:(e,t)=>caps.key.make("hb","bc",e,t),getAmazonCap:e=>caps.key.make("hb","bac",e),make:(...e)=>e.join("_")},counter:{make:(e,t,i)=>(null===expiryStorage.getItem(e)&&expiryStorage.setItem(e,t,i),{count:()=>expiryStorage.getItemValue(e),ttl:()=>expiryStorage.getItemExpires(e),setCount(t,i){expiryStorage.setItem(e,t,i)},incrCount(){expiryStorage.updateItemValue(e,this.count()+1,i)}})},winbidder:{key:e=>`hb_${PAGE_ID}_${e}`,incr(e){const t=this.key(e),i=expiryStorage.getItem(t);i?expiryStorage.updateItemValue(t,i.value+1,i.ttl):expiryStorage.setItem(t,1,864e5)},count(e){const t=this.key(e);return expiryStorage.getItemValue(t)||0}},check:{amazonCap(e,t){if(!e||!t)return!1;const i=caps.key.getAmazonCap(t),n=caps.counter.make(i,0,864e5);return!!(n.count()>=e)||(n.incrCount(),!1)},bidderCap(e,t){if(!(e&&e.cap&&t&&t.unitId))return!1;const i=caps.key.getBidderCap(e.bidder,t.unitId),n=caps.counter.make(i,0,864e5),o=e.cap;return!!(n.count()>=o)||(n.incrCount(),!1)},perPageCap(e,t){if(!(e&&e.pageCap&&t&&t.unitId&&t.pageId))return!1;if(!e.pageCap.skip&&!e.pageCap.repeat&&!e.pageCap.cap)return!1;const i=864e5,{pageCap:n}=e,{unitId:o,pageId:r}=t,d=caps.key.getSkip(e.bidder,o,r),s=caps.key.getRepeat(e.bidder,o,r),a=caps.key.getCap(e.bidder,o,r),c=n.skip,p=n.repeat,u=n.cap,l=caps.counter.make(d,0,i),g=caps.counter.make(s,0,i),b=caps.counter.make(a,0,i),m=!!n.capPerFill,w=l.count(),f=g.count(),h=m?t.winbidder:b.count();if(u>0&&h>=u)return!0;if(c>0&&w<c)return l.incrCount(),!0;if(p>0){if(f<p)return g.incrCount(),0!==f||(!m&&u>0&&b.incrCount(),!1);{const e=b.ttl();return g.setCount(0,e-(new Date).getTime()),!0}}return!m&&u>0&&b.incrCount(),!1}},filterBidders:(e,t)=>e.filter((e=>{const i=caps.winbidder.count(e.bidder);return!(caps.check.bidderCap(e,t)||caps.check.perPageCap(e,{...t,winbidder:i}))}))},ortbInfo={timeout:8e3,convertSizes:function(e){if(!e)return;if("string"==typeof e&&e.includes("x")&&(e=e.split("x").map((e=>parseInt(e)))),!e[0])return;let t=[];return Array.isArray(e[0])?e.forEach((e=>{t.push({w:e[0],h:e[1]})})):t.push({w:e[0],h:e[1]}),t}},createOrtb={nm:function(e,t){let i=ortbInfo.convertSizes(t.sizes||e.sizesAdUnit||e.size||e.sizes)||[300,250];return{bidder:"nm",endpoint:"https://pbs.nextmillmedia.com/openrtb2/auction",corsMode:"cors",body:{id:e.auctionId,source:{tid:e.auctionId,ext:{schain:{ver:"1.0",complete:1,nodes:[{asi:"nextmillennium.io",sid:"15170",hp:1}]}}},tmax:ortbInfo.timeout||8e3,imp:[{id:e.divId,ext:t.bidderParams||{},banner:{format:i}}],test:t.test||0,ext:t.rootExt,site:{publisher:{id:t.siteId||1},page:document.domain},device:{w:window.innerWidth||screen.availWidth,h:window.innerHeight||screen.availHeight},regs:{ext:{us_privacy:"1---"}}}}},loopme:function(e,t){let i=ortbInfo.convertSizes(t.sizes||e.sizesAdUnit||e.size||e.sizes)||[300,250];return{bidder:"loopMe",endpoint:"https://next-millennium-media-eu.loopmertb.com",corsMode:"no-cors",body:{id:e.auctionId,source:{tid:e.auctionId,ext:{schain:{ver:"1.0",complete:1,nodes:[{asi:"nextmillennium.io",sid:"15170",hp:1}]}}},tmax:8e3,imp:[{id:e.divId,ext:t.imp&&t.imp.biddersExt||{},ext:{},banner:{w:i[0].w,h:i[0].h,format:i}}],ext:{},site:{page:document.domain},device:{w:window.innerWidth||screen.availWidth,h:window.innerHeight||screen.availHeight,ip:t.ip,os:t.os,osv:t.osv,ua:window.navigator.userAgent},at:1,cur:["USD"],regs:{ext:{us_privacy:"1---"}}}}}};function wrapperPbjs(e){e.eventBus=createEventBus(),e.adMetrics=createMetrics(e.eventBus,e),e.startTime=Date.now(),e.eventBus.registerStartWrapper();const t=e.wPbjs||{};t.cmd=e.wPbjs.cmd||[],e.pWindow=void 0;try{e.parent.parent.document,e.pWindow=e.parent.parent.window}catch(t){try{e.parent.document,e.pWindow=e.parent.window}catch(t){e.pWindow=e}}e.tWindow=getTopWindow(e),e.setWinBid=ie;const i=12e5;let n,o,r,d=null,s=null,a={amazon:!1,pbjs:!1},c=!1,p=!1,u=null,l=0,g=[],b=[],m=null,w={},f={},h={},A=!1,y=!1,v="",S="",j=[],C={},x={},I={},E=0,P="",T=1,U=0,W=0,_=0,z=!1,k=!1,O=!1,B=null,D=!1;t.debug=function(e){if("1"===F("hbdebug"))return!0;return e.pWindow.location&&e.pWindow.location.search&&e.pWindow.location.search.replace(/^\?/,"").split("&").some((e=>"hbdebug=1"===e))}(e),t.run=function(p){if($.logger.log(`wPbjs.run (${p&&p.divId}) >>>`,t),p){if(e.pbjsAuctionId=s=p.auctionId,e.pbjsUnit=p.unit,p.unitRule&&(b=p.unitRule),b&&p.unitRulePercent){const e=p.unitRulePercent;n=100*Math.random()<e.percent?e.test_status:"Control"}if("string"==typeof p.customTargetings)try{p.customTargetings=JSON.parse(p.customTargetings)}catch(e){p.customTargetings=[]}if(Array.isArray(p.customTargetings)){let e=p.customTargetings.find((e=>"refresh"==e[0]));e&&(E=parseInt(e[1])||0),p.unitIds.keyValueRefresh=E,p.unitIds.unitRule=b.reduce(((e,t)=>(e[t.code]=t.price,e)),{})}if(e.pbjs.analyticAdapterOptions.data[s]={unitIds:p.unitIds},e.pbjs.adUnitExpire[s]=Date.now()+i,p.debug&&(t.debug=!0),$.logger.log("wPbjs => wPbjs.run >>> ",p,e.pbjs.analyticAdapterOptions),p.unitIndex&&(l=p.unitIndex),p.adUnitCodeToDFPPath&&(f=p.adUnitCodeToDFPPath),p.biddingRule&&(h=p.biddingRule),p.skipDFP&&(y=p.skipDFP),p.codeAdUnit&&(v=p.codeAdUnit),p.divId&&(S=p.divId),p.unitSizes){let e=p.unitSizes;$.logger.log(`wPbjs => paUnitSizes >>> (unitId = ${l}) Array = ${Array.isArray(e)}`,typeof e,JSON.stringify(e),"sizesAdUnit >>>",JSON.stringify(p.sizesAdUnit));try{"string"==typeof p.unitSizes&&(p.unitSizes=JSON.parse(p.unitSizes)),Array.isArray(p.unitSizes)||(p.unitSizes=[])}catch(e){console.error(`unitSizes parse >>> (unitId = ${l})`,p.unitSizes,e),p.unitSizes=[]}Array.isArray(p.unitSizes)&&p.unitSizes.length&&(p.sizesAdUnit=p.unitSizes,p.adUnits.forEach((e=>{/^1\-.+/.test(e.code)&&(e.mediaTypes.banner&&e.mediaTypes.banner.sizes&&(e.mediaTypes.banner.sizes=p.sizesAdUnit),e.mediaTypes.video&&e.mediaTypes.video.playerSize&&(e.mediaTypes.video.playerSize=p.sizesAdUnit))}))),$.logger.log(`wPbjs => set sizesAdUnit >>> (unitId = ${l})`,JSON.stringify(p.sizesAdUnit))}p.adUnits&&(p.adUnits=p.adUnits.map((e=>(e.bids=caps.filterBidders(e.bids,{unitId:l,pageId:PAGE_ID}),e))),g=p.adUnits),p.nmAd&&(x=p.nmAd),p.unitIds&&(I=p.unitIds),!p.skipDFP&&p.customTargetings&&(j=p.customTargetings),m=n||p.biddingRuleTestStatus,m&&j.push(["testStatus",m]),p.unit&&p.unit.domain&&(r=p.unit.domain),p.schain&&(o={ver:"1.0",complete:1,nodes:[{asi:p.schain.asi,sid:p.schain.sellerId,hp:1}]}),p.amazonBids=p.amazonBids&&!caps.check.amazonCap(p.amazonCap,l),u=function(e){try{const t=e.parent.frameElement.parentElement.id;return t?t.split("-").pop():($.logger.log("powerad ID not set"),"")}catch{return $.logger.log("powerad ID not set"),""}}(e);try{p.amazonBids&&!y&&(T++,function(t){!function(e,t,i,n,o,r,d){function s(i,n){t[e]._Q.push([i,n])}t[e]||(t[e]={init:function(){s("i",arguments)},fetchBids:function(){s("f",arguments)},setDisplayBids:function(){},targetingKeys:function(){return[]},_Q:[]},(r=i.createElement(n)).async=!0,r.src=o,(d=i.getElementsByTagName(n)[0]).parentNode.insertBefore(r,d))}("apstag",e,e.document,"script","//c.amazon-adsystem.com/aax2/apstag.js");let i,n={pubID:"79e40b05-e673-4b6c-85f9-79252a7f96a5",schain:o,bidTimeout:2e3};setTimeout(N,t.prebidBidTimeout||1500,t.type,a);let r={slots:[{sizes:t.sizesAdUnit}]};1==t.type&&(n.adServer="googletag",r.slots[0].slotName=t.codeAdUnit,r.slots[0].slotID=t.divId,i=function(t){a.amazon||e.googletag.cmd.push((function(){e.apstag.setDisplayBids(),N(1,a)}))});2==t.type&&(n.videoAdServer="DFP",r.slots[0].mediaType="video",r.slots[0].slotID="video_HB",i=function(e){if(!a.amazon){try{C=e&&e[0]&&e[0].qsParams&&e[0].qsParams.split("&").reduce(((e,t)=>{if(t){let i=t.split("=");e[i[0]]=i[1]}return e}),{})||{}}catch(e){console.error(e),C={}}N(2,a)}});e.apstag.init(n),e.apstag.fetchBids(r,i)}(p),A=p.amazonBids),function(t){$.logger.log(`wPbjs => (${S}) loadScripts!!!!!`);const i={src:"https://www.googletagservices.com/tag/js/gpt.js",async:!0};let n=[];t.skipDFP||n.push(i);t.isBidderSublime&&n.push({src:`//sac.ayads.co/sublime/${t.sublimeZoneId}/prebid`,async:!1});_loadJSScripts(e,n)}(p),p.nearEnabled&&!y&&function(e){e.googletag.cmd.push((function(){const t=e.npt||e.pWindow.npt;if(!t)return $.logger.error("wPbjs => npt not found >>> initNear"),void e.googletag.enableServices();function i(t){e.googletag.pubads().setPublisherProvidedId(t._ncid),e.googletag.enableServices()}t.setIdCallback(i),t.process()}))}(e),p.type&&1!=p.type?function(n){$.logger.log(`wPbjs => (${S}) >>> prebid video!!!!!`),e.adUnitSize=null,te(n.deducts),e.pbjs.que.push((function(){const r={debug:t.debug,priceGranularity:"high",consentManagement:{usp:{cmpApi:"iab",timeout:n.usPrivacyTimeout}},userSync:{filterSettings:{iframe:{bidders:"*",filter:"include"}}},cache:{url:n.cacheUrl},schain:{validation:"strict",config:o}};n.isGdrpIp&&(r.consentManagement.gdpr={cmpApi:"iab",defaultGdprScope:!0}),$.logger.log(`wPbjs => (${S}) pbjsConfig`,r),e.pbjs.setConfig(r),e.pbjs.addAdUnits(n.adUnits),e.pbjs.eventBidWonFuncs[s]={expire:Date.now()+i},e.pbjs.eventBidWonFuncs[s].func=function(t){$.logger.log(`wPbjs => (${S}) event bidWon`);try{e.pWindow.hb_win||(e.pWindow.hb_win={});var i=I[t.adUnitCode];ie(e,ne(u,i,n.divId,t)),e.pWindow.hb_win[i]||(e.pWindow.hb_win[i]={}),e.pWindow.hb_win[i][t.bidderCode]||(e.pWindow.hb_win[i][t.bidderCode]=0),e.pWindow.hb_win[i][t.bidderCode]++}catch(e){console.err(e)}},e.pbjs.requestBids({auctionId:s,adUnitCodes:n.adUnits.map((e=>e.code)),bidsBackHandler:Q,timeout:3e3})}))}(p):function(n){$.logger.log(`wPbjs => (${S}) >>> prebid banner!!!!! (Skip GAM = ${n.skipDFP})`),e.apAds=new Event("apAds"),e.apAdsLine=new Event("apAds_line"),e.apAdsX=new Event("apAds_x"),e.apAdsHide=new Event("apAds_hide"),e.adUnitSize=null,n.skipDFP?(console.log("frameWindow.googletag >>>",e.googletag),e.googletag.pubads=function(){return e.document.getElementById(n.divId)}):e.googletag.cmd.push((function(){e.googletag.pubads().disableInitialLoad()}));if(te(n.deducts),e.pbjs.que.push((function(){e.startAuctionTime=Date.now(),e.eventBus.registerStartAuction(e.pbjsAuctionId);const r={debug:t.debug,priceGranularity:"high",consentManagement:{usp:{cmpApi:"iab",timeout:n.usPrivacyTimeout}},userSync:{filterSettings:{iframe:{bidders:"*",filter:"include"}}},schain:{validation:"strict",config:o}};n.isLiveRamp&&(r.userSync.userIds=[{name:"identityLink",params:{pid:n.liverampPartnerId},storage:{type:"cookie",name:"idl_env",expires:1}}],r.userSync.syncDelay=n.userSyncDelay),n.isGdrpIp&&(r.consentManagement.gdpr={cmpApi:"iab",defaultGdprScope:!0}),n.pbsBidders.length&&($.logger.log("Serverside!"),r.s2sConfig={accountId:"1",enabled:!0,bidders:n.pbsBidders,endpoint:"https://pbs.nextmillmedia.com/openrtb2/auction",adapter:"prebidServer",cookieSet:!0,syncEndpoint:"https://pbs.nextmillmedia.com/cookie_sync"}),$.logger.log("wPbjs => pbjsConfig",r),e.pbjs.setConfig(r),e.pbjs.eventBidWonFuncs[s]={expire:Date.now()+i},e.pbjs.eventBidWonFuncs[s].func=function(t){try{if(!g.some((e=>e.code==t.adUnitCode)))return;caps.winbidder.incr(t.bidder),e.pbjs.eventBidWonFuncs[s].winBid=t,ie(e,ne(u,l,n.divId,t)),e.renderAdTime=Date.now(),e.eventBus.registerEndRenderAd(e.pbjsAuctionId),y&&e.adMetrics.flush(e.pbjsAuctionId,e.pbjsUnit,t),$.logger.log(`wPbjs => (${S}) >>> runned pbjs.renderAd`,t.adUnitCode);try{e.pWindow.hb_win||(e.pWindow.hb_win={});let i=n.unitIds[t.adUnitCode];e.pWindow.hb_win[i]||(e.pWindow.hb_win[i]={}),e.pWindow.hb_win[i][t.bidderCode]||(e.pWindow.hb_win[i][t.bidderCode]=0),e.pWindow.hb_win[i][t.bidderCode]++}catch(e){}let i=n.bidderOptions||{},o=n.size1x1||{};"gumgum"!=t.bidderCode&&"33across"!=t.bidderCode||($.logger.log("wPbjs => apAds_hide now fired (bidder: "+t.bidderCode+")"),e.document.dispatchEvent(e.apAdsHide),$.logger.log("wPbjs => option remove code (bidder: "+t.bidderCode+")"),"gumgum"==t.bidderCode&&(e.pWindow.document.querySelector("head").appendChild(e.pWindow.document.createElement("script")).innerHTML=`setTimeout(function() {for(let i of window.document.querySelectorAll('[id^=ad_is]')) {try{i.remove();} catch(e) {console.log('error removing apAds ad (gumgum):');}}},${n.gumgumRemovalTime})`),"33across"==t.bidderCode&&(e.pWindow.document.querySelector("head").appendChild(e.pWindow.document.createElement("script")).innerHTML=`setTimeout(function() {for(let i of window.document.querySelectorAll('[class^="ttx"],[id^="tynt"]')) {try{i.remove();} catch(e) {console.log('error removing apAds ad (33across):');}}},${n.gumgumRemovalTime})`));let r=g.find((e=>e.code===t.adUnitCode));if(!r)return void $.logger.log(`wPbjs (${S}) >>> error: ad unit not found`,t.adUnitCode);"undertone"==t.bidderCode&&($.logger.log("wPbjs => apAds now fired (bidder: "+t.bidderCode+")"),e.document.dispatchEvent(e.apAds),i[t.bidderCode].hideAd&&($.logger.log("wPbjs => apAds_hide now fired (bidder: "+t.bidderCode+")"),e.document.dispatchEvent(e.apAdsHide)),i[t.bidderCode].removeX&&($.logger.log("wPbjs => apAds_x now fired (bidder: "+t.bidderCode+")"),e.document.dispatchEvent(e.apAdsX)),i[t.bidderCode].removeCode&&($.logger.log("wPbjs => option remove code (bidder: "+t.bidderCode+")"),e.pWindow.document.querySelector("head").appendChild(e.pWindow.document.createElement("script")).innerHTML=`setTimeout(function() {try{window.document.querySelector('.ut_container').remove();} catch(e) {console.log('error removing apAds ad:');}},${n.gumgumRemovalTime})`),o[t.bidderCode]&&!r.sizes.some((e=>e[0]===t.width&&e[1]===t.height))&&i[t.bidderCode].inlineHeight&&($.logger.log("wPbjs => apAds_line now fired (bidder: "+t.bidderCode+")"),e.document.dispatchEvent(e.apAdsLine)));let d=!1;if("teads"==t.bidderCode&&o.teads&&i.teads.apAdsDiv&&(1===t.width&&1===t.height||!r.sizes.some((e=>e[0]===t.width&&e[1]===t.height)))){$.logger.log("wPbjs => apAds_div now fired (bidder: "+t.bidderCode+")"),e.document.dispatchEvent(e.apAds),d=!0;let i=new CustomEvent("apAds_div",{detail:t.adUnitCode});e.document.dispatchEvent(i)}["justpremium","sublime","teads","triplelift"].indexOf(t.bidderCode)>-1&&o[t.bidderCode]&&!r.sizes.some((e=>e[0]===t.width&&e[1]===t.height))&&(i[t.bidderCode].stopRefresh&&($.logger.log("wPbjs => apAds now fired (bidder: "+t.bidderCode+")"),d||(e.document.dispatchEvent(e.apAds),d=!0)),i[t.bidderCode].inlineHeight&&($.logger.log("wPbjs => apAds_line now fired (bidder: "+t.bidderCode+")"),e.document.dispatchEvent(e.apAdsLine)),i[t.bidderCode].removeX&&($.logger.log("wPbjs => apAds_x now fired (bidder: "+t.bidderCode+")"),e.document.dispatchEvent(e.apAdsX)),i[t.bidderCode].hideAd&&($.logger.log("wPbjs => apAds_hide now fired (bidder: "+t.bidderCode+")"),e.document.dispatchEvent(e.apAdsHide))),setTimeout(deleteEventBidWon,1e4,s)}catch(e){console.error(e)}},e.pbjs.addAdUnits(n.adUnits),c=!0,q(n)})),w={},!n.skipDFP){let i=[];n.sizeFluid&&i.push("fluid"),(!n.sizeFluid||n.sizeFluid&&!n.sizeFluidOnlyForGAM)&&(i=i.concat(n.sizesAdUnit)),e.googletag.cmd.push((function(){$.logger.log(`wPbjs => (${S}) >>> init GAM slots`);try{d=e.googletag.defineSlot(n.codeAdUnit,i,n.divId).addService(e.googletag.pubads()),e.googletag.pubads().enableSingleRequest(),!0!==n.nearEnabled&&e.googletag.enableServices(),q(n)}catch(e){$.logger.error(`wPbjs => (${S}) >>> Error: init GAM slots`,e),t.debug||console.error(e)}}))}setTimeout(V,3500,!0)}(p),p.ortbBidders.length&&!y&&(T++,O=p.ortbBidders,O=O.map((e=>createOrtb[e.bidder](p,e.params||{}))),function(e){if(!(e=e.filter((e=>e.endpoint&&e.body))).length)return M();W=e.length,e.forEach(((e,t)=>{fetch(e.endpoint,{method:"POST",headers:{"Content-Type":"application/json"},mode:e.corsMode,body:JSON.stringify(e.body)}).then((e=>{if(200===e.status)return e.json()})).then((e=>{if(!e)return M();M(e)})).catch((t=>{console.error("error from ortb bidder: ",e.bidder||"",t),M()}))})),settimeout((()=>{G()}),1500)}(O))}catch(e){console.error(e)}}};const $={logger:{title:"%chb-1.1",styles:{log:"color: white; font-weight: 700; background: #06d8c6; padding: 2px 4px; border-radius: 4px;",error:"color: white; font-weight: 700; background: #fd3c34; padding: 2px 4px; border-radius: 4px;"},log(){t.debug&&console.log.apply(console,[this.title,$.logger.styles.log,...arguments])},error(){t.debug&&console.error.apply(console,[this.title,$.logger.styles.error,...arguments])}}};function R(e){if("function"==typeof e)try{e.call()}catch(e){$.logger.error("Error processing command:",e.message,e.stack)}else $.logger.error("Command is not a function")}function F(t){let i=e.document.cookie.match(new RegExp("(?:^|; )"+t.replace(/([\.$?*|{}\(\)\[\]\\\/\\+^])/g,"\\$1")+"=([^;]*)"));return i?decodeURIComponent(i[1]):void 0}function N(e,t){t.amazon||(t.amazon=!0,1==e&&L("amazon"),2==e&&(p?K():p=!0))}t.renderOrtbAd=function(t,i){if(D)return;if(D=!0,!B||!B.bid)return;let n=e.document.createElement("iframe");n.setAttribute("frameborder",0),n.setAttribute("scrolling","no"),n.setAttribute("marginheight","0"),n.setAttribute("marginwidth","0"),n.setAttribute("hspace","0"),n.setAttribute("vspace","0"),n.setAttribute("topmargin",0),n.setAttribute("leftmargin",0),n.setAttribute("allowtransparency",!0),n.setAttribute("border","0px"),n.setAttribute("width",B.bid.w),n.setAttribute("height",B.bid.w),n.style.width=B.bid.w+"px",n.style.height=B.bid.h+"px";try{t.body.appendChild(n)}catch(e){return void console.error("failed to append ortb frame, ",e)}let o=n.contentDocument;o?(o.open(),o.write(B.bid.adm),o.close(),t.defaultView.frameElement.width=B.bid.w||300,t.defaultView.frameElement.height=B.bid.h||250):console.warn("failed to get frameDocument for ortb iframe")},t.renderAd=function(e,t){if(!x.id)return;$.logger.log(`wPbjs => (${S})renderAd - fakeAd nmAd.id=${x.id}`),e.defaultView.frameElement.width=x.size[0]||300,e.defaultView.frameElement.height=x.size[1]||250;let i=x.url||`https://hb.brainlyads.com/images/${x.img}`,n=e.createElement("img");n.src=i,n.style.padding="0px",n.style.margin="0px",n.style.border="0px",e.body.appendChild(n)},t.cmd.push=R,t.cmd.forEach((e=>{R(e)}));let J=[];function M(e){z||(e&&J.push(e),++_>=W&&function(){if(z)return G();if(z=!0,!J.length)return G();let e,t=0;J.forEach(((i,n)=>{i.seatbid.forEach(((i,n)=>{i.bid.forEach(((i,n)=>{i.price>t&&(e=i,t=i.price)}))}))})),e&&t&&(B={cpm:t,bid:e,size:[e.w||300,e.h||250]});G()}())}function G(){if(k)return;k=!0;let t={};if(!(B&&B.cpm&&B.bid))return L("openrtb");t={ortb_pb:B.cpm.toFixed(2),ortb_bidder:B.bidder||"unknown",ortb_size:(B.size||[300,250]).join("x"),auction_id:s},e.googletag.cmd.push((()=>{Object.entries(t).forEach((e=>{d.setTargeting(e[0],e[1])}))})),L("openrtb")}function q(t){(t.skipDFP||d&&c)&&e.pbjs.que.push((function(){$.logger.log(`wPbjs => (${S}) >>> run banner request`),e.pbjs.requestBids({auctionId:s,adUnitCodes:t.adUnits.map((e=>e.code)),bidsBackHandler:V,timeout:t.prebidBidTimeout})}))}function V(t){$.logger.log(`wPbjs => (${S}) ${t?">>> Timeout trigger ":""}>>> func initAdserver - satrt, pbjs.initAdserverSet =`,a.pbjs),a.pbjs||(e.endAuctionTime=Date.now(),e.eventBus.registerEndAuction(e.pbjsAuctionId),a.pbjs=!0,y?function(){$.logger.log(`wPbjs => (${S}) >>> initAdserverBannerSkipGAM`),e.googletag.cmd&&e.googletag.cmd[0]&&e.googletag.cmd[0]();let t=new CustomEvent("slotRenderEnded");t.isEmpty=!0,e.pbjs.que.push((function(){let i=ee(X()),n=i.adUnitCode;if($.logger.log("wPbjs => func initAdserver - selectWin, winAdUnitCode =",n),i.isWin){t.isEmpty=!1,t.size=e.adUnitSize;let i=e.pbjs.getAdserverTargetingForAdUnitCode(n);$.logger.log("wPbjs => func initAdserver - getAdserverTargetingForAdUnitCode, winTargetData =",i),i=JSON.parse(JSON.stringify(i)),w[n]=i,w[n].rendered=!1,e.dataPbjsWin={},e.dataPbjsWin[n]=i;let o=new Event("setTargeting");e.document.dispatchEvent(o),L("prebid - skipDFP")}e.googletag.pubads().dispatchEvent(t)}))}():($.logger.log(`wPbjs => (${S}) >>> initAdserverBannerGAM`),e.googletag.cmd.push((function(){e.pbjs.que.push((function(){let e=ee(X()),t=e.adUnitCode,i=e.bidData;$.logger.log(`wPbjs => (${S}) winAdUnitCode = ${t}`),j.forEach((e=>{Array.isArray(e)&&e.length>1&&d.setTargeting(String(e[0]),String(e[1]))}));let n="hb_pb";if(e.gamCpm&&!e.isWin&&(d.setTargeting("fp_pb",e.gamCpm.toFixed(2)),d.setTargeting("nm_id",x.id),Y(e.gamCpm)),$.logger.log(`wPbjs => (${S}) >>> winAdUnitCode = ${t}`),e.isWin){$.logger.log(`wPbjs => (${S}) >>> set targetings, winAdUnitCode = ${t}`);let o=i.adserverTargeting;Object.keys(o).forEach((e=>{d.setTargeting(e,o[e])}));let r=o&&parseFloat(o.hb_pb);d.setTargeting("orig_hb_pb",e.maxCpm.toFixed(2)),e.gamCpm&&e.maxCpm<e.gamCpm&&(r=e.gamCpm,d.setTargeting(n,r.toFixed(2)),Y(e.gamCpm)),H({biddingRule:h,cpm:r,divId:S,gptSlot:d,targets:o,winAdUnitCode:t})}else d.setTargeting("hb_pb","0.00"),d.setTargeting("orig_hb_pb","0.00");L("prebid")}))}))))}function H({biddingRule:e,cpm:t,divId:i,gptSlot:n,targets:o,winAdUnitCode:r}){if(Number.isNaN(t)||!(o&&e[o.hb_bidder]&&e[o.hb_bidder].value))return;let d=1==e[o.hb_bidder].type&&e[o.hb_bidder].value||2==e[o.hb_bidder].type&&e[o.hb_bidder].value*t||0;if(!d)return;let s=t+d;s=s.toFixed(2),n.setTargeting(keyHbPb,s),$.logger.log(`wPbjs => (${i}) set targetings, winAdUnitCode = `,r,"hb_bidder=",o.hb_bidder,"hb_pb=",o.hb_pb,"google hb_pb=",s);let a="hb_pb_"+o.hb_bidder;n.getTargeting(a).length&&(n.setTargeting(a,s),$.logger.log(`wPbjs => (${i}) >>> set targetings, winAdUnitCode = `,r,"hb_bidder=",o.hb_bidder,"hb_pb=",o.hb_pb,"google "+a+"=",s))}function L(t){$.logger.log(`wPbjs => (${S}) >>> bidderTypeComplete(${t})`,U+1,T),++U==T&&(e.eventBus.registerStartRenderAd(e.pbjsAuctionId),y?function(){if($.logger.log(`wPbjs => (${S}) >>> renderAd - start`),!w)return;let t=Object.keys(w);$.logger.log(`wPbjs => (${S}) func renderAd - codes = `,t),t.forEach((t=>{if(w[t].rendered)return;w[t].rendered=!0;let i=e.document.getElementById(S);if($.logger.log(`wPbjs => (${S}) func renderAd - block = `,i),!i)return;let n=e.document.createElement("iframe");n.id=`google_ads_iframe_${S}_0`,n.setAttribute("frameborder",0),n.setAttribute("scrolling","no"),n.setAttribute("marginheight","0"),n.setAttribute("marginwidth","0"),n.setAttribute("hspace","0"),n.setAttribute("vspace","0"),n.setAttribute("topmargin",0),n.setAttribute("leftmargin",0),n.setAttribute("allowtransparency",!0),n.setAttribute("width",0),n.setAttribute("height",0),n.setAttribute("border","0px"),n.style.border="0",i.appendChild(n);let o=w[t],r=n.contentWindow.document;o&&o.hb_adid&&($.logger.log(`wPbjs => (${S}) func renderAd - RUN pbjs.renderAd, adServerTargeting = `,o),e.pbjs.renderAd(r,o.hb_adid)),delete w[t]}))}():e.googletag.cmd.push((()=>{try{e.googletag.pubads().addEventListener("slotRenderEnded",(function(){e.eventBus.registerSlotRenderEnded(e.pbjsAuctionId)})),e.googletag.pubads().addEventListener("slotOnload",(function(){e.eventBus.registerSlotOnload(e.pbjsAuctionId);const t=e.pbjs.eventBidWonFuncs[e.pbjsAuctionId],i=t?t.winBid:null;i&&e.adMetrics.flush(e.pbjsAuctionId,e.pbjsUnit,i)})),e.googletag.pubads().addEventListener("impressionViewable",(function(){e.eventBus.registerImpressionViewable(e.pbjsAuctionId)})),$.logger.log(`wPbjs => (${S}) >>> GPT refresh`,d),e.googletag.pubads().refresh([d])}catch(e){console.error(e)}})))}function X(){return $.logger.log(`wPbjs => (${S}) >>> getAllBidResponeses`),g.map((e=>e.code)).reduce(((t,i)=>{let n=e.pbjs.getBidResponsesForAdUnitCode(i);return n&&(t[i]=n),t}),{})}function Q(){$.logger.log(`wPbjs => (${S}) >>> run initAdserver video`);let e=ee(X());P=e.adUnitCode,(!A||A&&p)&&K(),A&&!p&&(p=!0)}function K(){$.logger.log(`wPbjs => (${S}) >>> run video`);let t=P||Object.keys(f)[0],i=j.reduce(((e,t)=>(Array.isArray(t)&&t.length>1&&(e[String(t[0])]=String(t[1])),e)),C),n=pbjs.adServers.dfp.buildVideoUrl({adUnit:g.find((function(e){return e.code==t})),bid:!P&&{}||void 0,params:{iu:f[t],cust_params:i,output:"vast"}});P&&e.pbjs.markWinningBidAsUsed({adUnitCode:P}),$.logger.log(`wPbjs => (${S}) >>> vastURL =`,n);let o=e.document.getElementById(S);o&&e.vastAd&&e.vastAd(n,o)}function Y(e){Z({eventName:"gamFloorprice",data:{auctionId:s,bidder:"gam",unitId:I&&I[Object.keys(I)[0]],domain:r,floorprice:parseFloat(e)},host:window.top&&window.top.location&&window.top.location.host||"",timestamp:Date.now()})}function Z(t){var i;e.pbjs._nextMillenniumStatistic?e.pbjs._nextMillenniumStatistic.add(t):(i=[t],fetch("https://report2.hb.brainlyads.com/statistics",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(i)}))}function ee(t){$.logger.log(`wPbjs => (${S}) >>> selectWin`,t);let i=b,n=Object.keys(t),o=[];for(let e=0;e<n.length;e++){let i=g.find((t=>t.code===n[e])),r=i.mediaTypes.banner&&i.mediaTypes.banner.sizes||i.mediaTypes.video&&i.mediaTypes.video.playerSize||"",d=0;o.push({winAdUnitCode:"",winAdUnitData:null});for(let i=0;i<t[n[e]].bids.length;i++)$.logger.log(`wPbjs => (${S}) Response: adUnitCode=`+n[e]+" cpm=$"+t[n[e]].bids[i].cpm+" bidder="+t[n[e]].bids[i].bidder+(r&&" unitSizes="+JSON.stringify(r)||"")+" responseSize=["+t[n[e]].bids[i].width+","+t[n[e]].bids[i].height+"]"),t[n[e]].bids[i].cpm>d&&(o[e].winAdUnitCode=n[e],o[e].winAdUnitData=t[n[e]].bids[i],d=t[n[e]].bids[i].cpm)}$.logger.log(`wPbjs => (${S}) winsAdUnit >>>`,o);let d,a={isWin:!1,adUnitCode:"",bidData:null,maxCpm:0,gamCpm:0},c=i.find((e=>"gam"===e.code));a.gamCpm=c&&c.price||0;for(let e=0;e<o.length;e++)o[e].winAdUnitCode&&o[e].winAdUnitData.cpm>a.maxCpm&&(a.adUnitCode=o[e].winAdUnitCode,a.bidData=o[e].winAdUnitData,a.maxCpm=o[e].winAdUnitData.cpm);if($.logger.log(`wPbjs => (${S}) response >>>`,a),a.adUnitCode){d=g.find((e=>e.code===a.adUnitCode));let e=i.find((e=>e.code===a.bidData.bidderCode)),t=e&&e.price;if(!t&&"rhythmone"==a.bidData.bidderCode){let e=d.bids.find((e=>"rhythmone"==e.bidder));t=e&&e.params&&e.params.floor||options.defaultFloorRhythmone}(!t||t&&t<=a.bidData.cpm)&&(a.isWin=!0,t&&t>0&&($.logger.log(`wPbjs => (${S}) floorprice >>>`,t),I.floorprice=t))}var p;return a.isWin&&(e.adUnitSize=[a.bidData.width,a.bidData.height],$.logger.log(`wPbjs => (${S}) Winner: adUnitCode=`+a.adUnitCode+" cpm=$"+a.bidData.cpm+" bidder="+a.bidData.bidder+" unitSizes="+JSON.stringify(d.sizes)+" responseSize=["+a.bidData.width+","+a.bidData.height+"]"),p=a.bidData,Z({eventName:"winBid",data:{auctionId:s,bidder:p.bidder,unitId:I&&I[Object.keys(I)[0]],domain:r,refresh:I.keyValueRefresh,floorprice:I.unitRule[p.bidder]||void 0},host:window.top&&window.top.location&&window.top.location.host||"",timestamp:Date.now()})),a}function te(t){let i=Object.keys(t);if(!t||i.length)return null;let n={};for(let e=0;e<i.length;e++)n[i[e]]={bidCpmAdjustment:function(n,o){return n*t[i[e]]}};e.pbjs.bidderSettings=n}function ie(e,t){try{$.logger.log("event bidWon: info",t),e.pWindow.paGlobal||(e.pWindow.paGlobal={}),e.pWindow.paGlobal.data||(e.pWindow.paGlobal.data={}),e.pWindow.paGlobal.data[t.paId]||(e.pWindow.paGlobal.data[t.paId]={}),e.pWindow.paGlobal.data[t.paId].winningBid=copySafe(t),function(e,t,i){t=`hb:${t}`;try{e.tWindow.postMessage(JSON.stringify({event:t,payload:i}),"*")}catch(e){console.error(e)}}(e,"bidWon",t)}catch(e){console.error(e)}}function ne(e,t,i,n={}){return{paId:e,unitId:t,divId:i,bidderCode:n.bidderCode,mediaType:n.mediaType,adDomain:n.adserverTargeting?n.adserverTargeting.hb_adomain:""}}}function loadJSScripts(e,t){console.log("loadJSScripts!!!!!");let i=[];const n={src:"https://hb.brainlyads.com/prebid.nm.1.0.js",async:!0};i.push({src:"https://js-sec.indexww.com/ht/p/188333-91751857837145.js",async:!0});let o=[n],r=!1,d=()=>{r||(r=!0,_loadJSScripts(e,o))};e.PWT.jsLoaded=d;let s=e.location.href,a="";if(s.indexOf("pwtv=")>0){let e=/pwtv=(.*?)(&|$)/g.exec(s);e.length>=2&&e[1].length>0&&(a=`/${e[1]}`)}i.push({src:`//ads.pubmatic.com/AdServer/js/pwt/157577/2378${a}/pwt.js`,async:!0}),_loadJSScripts(e,i,t),setTimeout(d,100)}function _loadJSScripts(e,t,i){if(!Array.isArray(t))return;let n=e.document.getElementsByTagName("script")[0],o=0;t.forEach((r=>{let d=e.document.createElement("script");d.async=!!r.async,d.type="text/javascript",d.src=r.src,"function"==typeof i&&(d.onload=function(){++o==t.length&&i()});try{n.parentNode.insertBefore(d,n)}catch(e){console.error(e)}}))}function deleteEventBidWon(e){window.pbjs.eventBidWonFuncs[e]&&delete window.pbjs.eventBidWonFuncs[e]}function cleanerAdUnitExpire(){const e=Date.now();Object.keys(window.pbjs.adUnitExpire).forEach((t=>{e>window.pbjs.adUnitExpire[t]&&(delete window.pbjs.adUnitExpire[t],window.pbjs.que.push((()=>{window.pbjs.analyticAdapterOptions.data[t]&&(Object.keys(window.pbjs.analyticAdapterOptions.data[t]).forEach((e=>{window.pbjs.removeAdUnit(e)})),delete window.pbjs.analyticAdapterOptions.data[t])})),window.eventBus&&window.eventBus.cleanAuction(t)),window.pbjs.eventBidWonFuncs[t]&&e>window.pbjs.eventBidWonFuncs[t].expire&&delete window.pbjs.eventBidWonFuncs[t]})),setTimeout(cleanerAdUnitExpire,6e4)}function createEventBus(){const e={startWrapper:"startWrapper",startAuction:"startAuction",endAuction:"endAuction",startRenderAd:"startRenderAd",endRenderAd:"endRenderAd",slotRenderEnded:"slotRenderEnded",slotOnload:"slotOnload",impressionViewable:"impressionViewable"},t={auctions:{}};let i={event:""};const n={debug:!1},o={events:t,state:i,eventsList:()=>Object.values(e),registerStartWrapper:function(){var i;t[i=e.startWrapper]=d(i),s(i),a(t[i]),t[i]},registerStartAuction:function(t){r(e.startAuction,t)},registerEndAuction:function(t){r(e.endAuction,t)},registerStartRenderAd:function(t){r(e.startRenderAd,t)},registerEndRenderAd:function(t){r(e.endRenderAd,t)},registerSlotRenderEnded:function(t){r(e.slotRenderEnded,t)},registerSlotOnload:function(t){r(e.slotOnload,t)},registerImpressionViewable:function(t){r(e.impressionViewable,t)},cleanAuction:function(e){delete t.auctions[e]},getStartWrapper:()=>t[e.startWrapper]||null,getStartAuction:t=>o.getAuctionEvent(t,e.startAuction),getEndAuction:t=>o.getAuctionEvent(t,e.endAuction),getStartRenderAd:t=>o.getAuctionEvent(t,e.startRenderAd),getEndRenderAd:t=>o.getAuctionEvent(t,e.endRenderAd),getSlotRenderEnded:t=>o.getAuctionEvent(t,e.slotRenderEnded),getSlotOnload:t=>o.getAuctionEvent(t,e.slotOnload),getImpressionViewable:t=>o.getAuctionEvent(t,e.impressionViewable),getAuctionEvent(e,i){const n=t.auctions[e];return n&&n[i]?n[i]:null},setDebug(e){n.debug=e}};return o;function r(e,i){return t.auctions[i]||(t.auctions[i]={}),t.auctions[i][e]=d(e),s(e),a(t.auctions[i][e]),t.auctions[i][e]}function d(e,t){const i={name:e,timestamp:Date.now(),performanceTime:performance?performance.now():null};return t&&(i.auctionId=t),i}function s(e){i.event=e}function a(e){if(!0===n.debug){const t=[e.auctionId?e.auctionId+":"+e.name:e.name,"Timestamp: "+e.timestamp,"PerfomanceTime: "+e.performanceTime];utils.logger.log(t.join("; "))}}}function createMetrics(e,t){const i={flush:function(e,t,n){try{const o={name:t&&t.name,domain:t&&t.domain,bidder:n&&n.bidderCode,metrics:i.calculate(e)};return i.send(o)}catch(e){console.error(e)}},calculate:function(e){const i={auctionInit:n(e),auctionHolding:o(e),renderAd:r(e),slotRenderEnded:d(e),slotOnload:s(e),prebidStartDuration:t.startAuctionTime-t.startTime,auctionDuration:t.endAuctionTime-t.startAuctionTime,renderAdDuration:t.renderAdTime-t.endAuctionTime};return Object.keys(i).forEach((e=>{null===i[e]&&delete i[e]})),i},send(e){fetch("https://hb.brainlyads.com/metrics",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)})}};return i;function n(t){return a(e.getStartWrapper(),e.getStartAuction(t))}function o(t){return a(e.getStartAuction(t),e.getEndAuction(t))}function r(t){return a(e.getStartRenderAd(t),e.getEndRenderAd(t))}function d(t){return a(e.getStartRenderAd(t),e.getSlotRenderEnded(t))}function s(t){return a(e.getStartRenderAd(t),e.getSlotOnload(t))}function a(e,t){let i=null;return e&&t?(i=e.hasOwnProperty("performanceTime")&&t.hasOwnProperty("performanceTime")?t.performanceTime-e.performanceTime:t.timestamp-e.timestamp,i=i>0?i:Math.abs(i),i=Math.round(i),i):i}}function getTopWindow(e,t=0){if(t>10)return e;try{return e.parent.document,getTopWindow(e.parent.window,++t)}catch(t){return e}}function JSONParseSafe(e){try{return JSON.parse(e)}catch(e){return console.error(e),null}}function copySafe(e){try{return JSON.parse(JSON.stringify(e))}catch(e){return console.error(e),null}}function uuidv4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}window.startTime=window.startTime||Date.now(),window.PWT=window.PWT||{},window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],window.pbjs=window.pbjs||{},window.pbjs.que=window.pbjs.que||[],window.pbjs.analyticAdapterOptions={version:"1.0",data:{},auctions:{}},window.pbjs.adUnitExpire={},window.pbjs.eventBidWonFuncs={},window.pbjs.que.push((function(){window.pbjs.enableAnalytics([{provider:"nextMillennium",options:window.pbjs.analyticAdapterOptions}]),window.pbjs.onEvent("bidWon",(function(e){window.pbjs.eventBidWonFuncs[e.auctionId]&&window.pbjs.eventBidWonFuncs[e.auctionId].func(e)}))})),cleanerAdUnitExpire(),expiryStorage.garbageCollector("hb_");
