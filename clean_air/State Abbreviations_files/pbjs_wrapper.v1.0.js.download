"use strict";const versionPW="1.0",HOUR_SECONDS=36e5,DAY_SECONDS=864e5,PAGE_ID=uuidv4(),expiryStorage={getItem(e){const t=expiryStorage.getJSON(e);return t?this.isExpire(t)?(localStorage.removeItem(e),null):t:null},getItemValue(e){const t=expiryStorage.getItem(e);return t?t.value:null},getItemExpires(e){const t=expiryStorage.getItem(e);return t?t.expires:null},setItem(e,t,n){const i={value:t,expires:(new Date).getTime()+n};expiryStorage.setJSON(e,i)},updateItemValue(e,t){const n=expiryStorage.getJSON(e);return!!n&&(n.value=t,expiryStorage.setJSON(e,n),!0)},updateItemExpires(e,t){const n=expiryStorage.getJSON(e);return!!n&&(n.expires=t,expiryStorage.setJSON(e,n),!0)},getJSON(e){const t=localStorage.getItem(e);return t?JSONParseSafe(t):null},setJSON:(e,t)=>localStorage.setItem(e,JSON.stringify(t)),isExpire:e=>(new Date).getTime()>e.expires,garbageCollector(e,t=36e5){setTimeout((()=>{Object.keys(localStorage).forEach((t=>{0===t.indexOf(e)&&this.getItem(t)})),this.garbageCollector(e,t)}),t)}},caps={key:{getSkip:(e,t,n)=>caps.key.make("hb","skc",e,t,n,"s"),getRepeat:(e,t,n)=>caps.key.make("hb","skc",e,t,n,"r"),getCap:(e,t,n)=>caps.key.make("hb","skc",e,t,n,"c"),getBidderCap:(e,t)=>caps.key.make("hb","bc",e,t),getAmazonCap:e=>caps.key.make("hb","bac",e),make:(...e)=>e.join("_")},counter:{make:(e,t,n)=>(null===expiryStorage.getItem(e)&&expiryStorage.setItem(e,t,n),{count:()=>expiryStorage.getItemValue(e),ttl:()=>expiryStorage.getItemExpires(e),setCount(t,n){expiryStorage.setItem(e,t,n)},incrCount(){expiryStorage.updateItemValue(e,this.count()+1,n)}})},winbidder:{key:e=>`hb_${PAGE_ID}_${e}`,incr(e){const t=this.key(e),n=expiryStorage.getItem(t);n?expiryStorage.updateItemValue(t,n.value+1,n.ttl):expiryStorage.setItem(t,1,864e5)},count(e){const t=this.key(e);return expiryStorage.getItemValue(t)||0}},check:{amazonCap(e,t){if(!e||!t)return!1;const n=caps.key.getAmazonCap(t),i=caps.counter.make(n,0,864e5);return!!(i.count()>=e)||(i.incrCount(),!1)},bidderCap(e,t){if(!(e&&e.cap&&t&&t.unitId))return!1;const n=caps.key.getBidderCap(e.bidder,t.unitId),i=caps.counter.make(n,0,864e5),o=e.cap;return!!(i.count()>=o)||(i.incrCount(),!1)},perPageCap(e,t){if(!(e&&e.pageCap&&t&&t.unitId&&t.pageId))return!1;if(!e.pageCap.skip&&!e.pageCap.repeat&&!e.pageCap.cap)return!1;const n=864e5,{pageCap:i}=e,{unitId:o,pageId:d}=t,r=caps.key.getSkip(e.bidder,o,d),s=caps.key.getRepeat(e.bidder,o,d),a=caps.key.getCap(e.bidder,o,d),c=i.skip,p=i.repeat,u=i.cap,l=caps.counter.make(r,0,n),g=caps.counter.make(s,0,n),b=caps.counter.make(a,0,n),m=!!i.capPerFill,w=l.count(),f=g.count(),h=m?t.winbidder:b.count();if(u>0&&h>=u)return!0;if(c>0&&w<c)return l.incrCount(),!0;if(p>0){if(f<p)return g.incrCount(),0!==f||(!m&&u>0&&b.incrCount(),!1);{const e=b.ttl();return g.setCount(0,e-(new Date).getTime()),!0}}return!m&&u>0&&b.incrCount(),!1}},filterBidders:(e,t)=>e.filter((e=>{const n=caps.winbidder.count(e.bidder);return!(caps.check.bidderCap(e,t)||caps.check.perPageCap(e,{...t,winbidder:n}))}))},ortbInfo={timeout:8e3,convertSizes:function(e){if(!e)return;if("string"==typeof e&&e.includes("x")&&(e=e.split("x").map((e=>parseInt(e)))),!e[0])return;let t=[];return Array.isArray(e[0])?e.forEach((e=>{t.push({w:e[0],h:e[1]})})):t.push({w:e[0],h:e[1]}),t}},createOrtb={nm:function(e,t){let n=ortbInfo.convertSizes(t.sizes||e.sizesAdUnit||e.size||e.sizes)||[300,250];return{bidder:"nm",endpoint:"https://pbs.nextmillmedia.com/openrtb2/auction",corsMode:"cors",body:{id:e.auctionId,source:{tid:e.auctionId,ext:{schain:{ver:"1.0",complete:1,nodes:[{asi:"nextmillennium.io",sid:"15170",hp:1}]}}},tmax:ortbInfo.timeout||8e3,imp:[{id:e.divId,ext:t.bidderParams||{},banner:{format:n}}],test:t.test||0,ext:t.rootExt,site:{publisher:{id:t.siteId||1},page:document.domain},device:{w:window.innerWidth||screen.availWidth,h:window.innerHeight||screen.availHeight},regs:{ext:{us_privacy:"1---"}}}}},loopme:function(e,t){let n=ortbInfo.convertSizes(t.sizes||e.sizesAdUnit||e.size||e.sizes)||[300,250];return{bidder:"loopMe",endpoint:"https://next-millennium-media-eu.loopmertb.com",corsMode:"no-cors",body:{id:e.auctionId,source:{tid:e.auctionId,ext:{schain:{ver:"1.0",complete:1,nodes:[{asi:"nextmillennium.io",sid:"15170",hp:1}]}}},tmax:8e3,imp:[{id:e.divId,ext:t.imp&&t.imp.biddersExt||{},ext:{},banner:{w:n[0].w,h:n[0].h,format:n}}],ext:{},site:{page:document.domain},device:{w:window.innerWidth||screen.availWidth,h:window.innerHeight||screen.availHeight,ip:t.ip,os:t.os,osv:t.osv,ua:window.navigator.userAgent},at:1,cur:["USD"],regs:{ext:{us_privacy:"1---"}}}}}};function wrapperPbjs(e){e.eventBus=createEventBus(),e.adMetrics=createMetrics(e.eventBus,e),e.startTime=Date.now(),e.eventBus.registerStartWrapper();const t=e.wPbjs||{};t.cmd=e.wPbjs.cmd||[],e.pWindow=void 0;try{e.parent.parent.document,e.pWindow=e.parent.parent.window}catch(t){try{e.parent.document,e.pWindow=e.parent.window}catch(t){e.pWindow=e}}e.tWindow=getTopWindow(e),e.setWinBid=ee;const n=12e5;let i,o,d=null,r=null,s={amazon:!1,pbjs:!1},a=!1,c=!1,p=null,u=0,l=[],g=[],b={},m={},w={},f=!1,h=!1,A="",y="",v=[],S={},j={},C={},x=0,E="",I=1,T=0,P=0,U=0,W=!1,_=!1,k=!1,z=null,B=!1;t.debug=function(e){if("1"===R("hbdebug"))return!0;return e.pWindow.location&&e.pWindow.location.search&&e.pWindow.location.search.replace(/^\?/,"").split("&").some((e=>"hbdebug=1"===e))}(e),t.run=function(c){if(D.logger.log(`wPbjs.run (${c&&c.divId}) >>>`,t),c){if(e.pbjsAuctionId=r=c.auctionId,e.pbjsUnit=c.unit,c.unitRule&&(g=c.unitRule),Array.isArray(c.customTargetings)){let e=c.customTargetings.find((e=>"refresh"==e[0]));e&&(x=parseInt(e[1])||0),c.unitIds.keyValueRefresh=x,c.unitIds.unitRule=g.reduce(((e,t)=>(e[t.code]=t.price,e)),{})}if(e.pbjs.analyticAdapterOptions.data[r]={unitIds:c.unitIds},e.pbjs.adUnitExpire[r]=Date.now()+n,c.debug&&(t.debug=!0),D.logger.log("wPbjs => wPbjs.run >>> ",c,e.pbjs.analyticAdapterOptions),c.unitIndex&&(u=c.unitIndex),c.adUnitCodeToDFPPath&&(m=c.adUnitCodeToDFPPath),c.biddingRule&&(w=c.biddingRule),c.skipDFP&&(h=c.skipDFP),c.codeAdUnit&&(A=c.codeAdUnit),c.divId&&(y=c.divId),c.unitSizes){try{"string"==typeof c.unitSizes&&(c.unitSizes=JSON.parse(c.unitSizes)),Array.isArray(c.unitSizes)||(c.unitSizes=[])}catch(e){c.unitSizes=[]}Array.isArray(c.unitSizes)&&c.unitSizes.length&&(c.sizesAdUnit=c.unitSizes,c.adUnits.forEach((e=>{/^1\-.+/.test(e.code)&&(e.mediaTypes.banner&&e.mediaTypes.banner.sizes&&(e.mediaTypes.banner.sizes=c.sizesAdUnit),e.mediaTypes.video&&e.mediaTypes.video.playerSize&&(e.mediaTypes.video.playerSize=c.sizesAdUnit))})))}c.adUnits&&(c.adUnits=c.adUnits.map((e=>(e.bids=caps.filterBidders(e.bids,{unitId:u,pageId:PAGE_ID}),e))),l=c.adUnits),c.nmAd&&(j=c.nmAd),c.unitIds&&(C=c.unitIds),!c.skipDFP&&c.customTargetings&&(v=c.customTargetings),c.unit&&c.unit.domain&&(o=c.unit.domain),c.schain&&(i={ver:"1.0",complete:1,nodes:[{asi:c.schain.asi,sid:c.schain.sellerId,hp:1}]}),c.amazonBids=c.amazonBids&&!caps.check.amazonCap(c.amazonCap,u),p=function(e){try{const t=e.parent.frameElement.parentElement.id;return t?t.split("-").pop():(D.logger.log("powerad ID not set"),"")}catch{return D.logger.log("powerad ID not set"),""}}(e);try{c.amazonBids&&!h&&(I++,function(t){!function(e,t,n,i,o,d,r){function s(n,i){t[e]._Q.push([n,i])}t[e]||(t[e]={init:function(){s("i",arguments)},fetchBids:function(){s("f",arguments)},setDisplayBids:function(){},targetingKeys:function(){return[]},_Q:[]},(d=n.createElement(i)).async=!0,d.src=o,(r=n.getElementsByTagName(i)[0]).parentNode.insertBefore(d,r))}("apstag",e,e.document,"script","//c.amazon-adsystem.com/aax2/apstag.js");let n,o={pubID:"79e40b05-e673-4b6c-85f9-79252a7f96a5",schain:i,bidTimeout:2e3};setTimeout($,t.prebidBidTimeout||1500,t.type,s);let d={slots:[{sizes:t.sizesAdUnit}]};1==t.type&&(o.adServer="googletag",d.slots[0].slotName=t.codeAdUnit,d.slots[0].slotID=t.divId,n=function(t){s.amazon||e.googletag.cmd.push((function(){e.apstag.setDisplayBids(),$(1,s)}))});2==t.type&&(o.videoAdServer="DFP",d.slots[0].mediaType="video",d.slots[0].slotID="video_HB",n=function(e){if(!s.amazon){try{S=e&&e[0]&&e[0].qsParams&&e[0].qsParams.split("&").reduce(((e,t)=>{if(t){let n=t.split("=");e[n[0]]=n[1]}return e}),{})||{}}catch(e){console.error(e),S={}}$(2,s)}});e.apstag.init(o),e.apstag.fetchBids(d,n)}(c),f=c.amazonBids),function(t){D.logger.log(`wPbjs => (${y}) loadScripts!!!!!`);const n={src:"https://www.googletagservices.com/tag/js/gpt.js",async:!0};let i=[];t.skipDFP||i.push(n);t.isBidderSublime&&i.push({src:`//sac.ayads.co/sublime/${t.sublimeZoneId}/prebid`,async:!1});_loadJSScripts(e,i)}(c),c.nearEnabled&&!h&&function(e){e.googletag.cmd.push((function(){const t=e.npt||e.pWindow.npt;if(!t)return D.logger.error("wPbjs => npt not found >>> initNear"),void e.googletag.enableServices();function n(t){e.googletag.pubads().setPublisherProvidedId(t._ncid),e.googletag.enableServices()}t.setIdCallback(n),t.process()}))}(e),c.type&&1!=c.type?function(o){D.logger.log(`wPbjs => (${y}) >>> prebid video!!!!!`),e.adUnitSize=null,Z(o.deducts),e.pbjs.que.push((function(){const d={debug:t.debug,priceGranularity:"high",consentManagement:{usp:{cmpApi:"iab",timeout:o.usPrivacyTimeout}},userSync:{filterSettings:{iframe:{bidders:"*",filter:"include"}}},cache:{url:o.cacheUrl},schain:{validation:"strict",config:i}};o.isGdrpIp&&(d.consentManagement.gdpr={cmpApi:"iab",defaultGdprScope:!0}),D.logger.log(`wPbjs => (${y}) pbjsConfig`,d),e.pbjs.setConfig(d),e.pbjs.addAdUnits(o.adUnits),e.pbjs.eventBidWonFuncs[r]={expire:Date.now()+n},e.pbjs.eventBidWonFuncs[r].func=function(t){D.logger.log(`wPbjs => (${y}) event bidWon`);try{e.pWindow.hb_win||(e.pWindow.hb_win={});var n=C[t.adUnitCode];ee(e,te(p,n,o.divId,t)),e.pWindow.hb_win[n]||(e.pWindow.hb_win[n]={}),e.pWindow.hb_win[n][t.bidderCode]||(e.pWindow.hb_win[n][t.bidderCode]=0),e.pWindow.hb_win[n][t.bidderCode]++}catch(e){}},e.pbjs.requestBids({auctionId:r,adUnitCodes:o.adUnits.map((e=>e.code)),bidsBackHandler:L,timeout:3e3})}))}(c):function(o){D.logger.log(`wPbjs => (${y}) >>> prebid banner!!!!! (Skip GAM = ${o.skipDFP})`),e.apAds=new Event("apAds"),e.apAdsLine=new Event("apAds_line"),e.apAdsX=new Event("apAds_x"),e.apAdsHide=new Event("apAds_hide"),e.adUnitSize=null,o.skipDFP?(console.log("frameWindow.googletag >>>",e.googletag),e.googletag.pubads=function(){return e.document.getElementById(o.divId)}):e.googletag.cmd.push((function(){e.googletag.pubads().disableInitialLoad()}));if(Z(o.deducts),e.pbjs.que.push((function(){e.startAuctionTime=Date.now(),e.eventBus.registerStartAuction(e.pbjsAuctionId);const d={debug:t.debug,priceGranularity:"high",consentManagement:{usp:{cmpApi:"iab",timeout:o.usPrivacyTimeout}},userSync:{filterSettings:{iframe:{bidders:"*",filter:"include"}}},schain:{validation:"strict",config:i}};o.isLiveRamp&&(d.userSync.userIds=[{name:"identityLink",params:{pid:o.liverampPartnerId},storage:{type:"cookie",name:"idl_env",expires:1}}],d.userSync.syncDelay=o.userSyncDelay),o.isGdrpIp&&(d.consentManagement.gdpr={cmpApi:"iab",defaultGdprScope:!0}),o.pbsBidders.length&&(D.logger.log("Serverside!"),d.s2sConfig={accountId:"1",enabled:!0,bidders:o.pbsBidders,endpoint:"https://pbs.nextmillmedia.com/openrtb2/auction",adapter:"prebidServer",cookieSet:!0,syncEndpoint:"https://pbs.nextmillmedia.com/cookie_sync"}),D.logger.log("wPbjs => pbjsConfig",d),e.pbjs.setConfig(d),e.pbjs.eventBidWonFuncs[r]={expire:Date.now()+n},e.pbjs.eventBidWonFuncs[r].func=function(t){try{if(!l.some((e=>e.code==t.adUnitCode)))return;caps.winbidder.incr(t.bidder),e.pbjs.eventBidWonFuncs[r].winBid=t,ee(e,te(p,u,o.divId,t)),e.renderAdTime=Date.now(),e.eventBus.registerEndRenderAd(e.pbjsAuctionId),h&&e.adMetrics.flush(e.pbjsAuctionId,e.pbjsUnit,t),D.logger.log(`wPbjs => (${y}) >>> runned pbjs.renderAd`,t.adUnitCode);try{e.pWindow.hb_win||(e.pWindow.hb_win={});let n=o.unitIds[t.adUnitCode];e.pWindow.hb_win[n]||(e.pWindow.hb_win[n]={}),e.pWindow.hb_win[n][t.bidderCode]||(e.pWindow.hb_win[n][t.bidderCode]=0),e.pWindow.hb_win[n][t.bidderCode]++}catch(e){}let n=o.bidderOptions||{},i=o.size1x1||{};"gumgum"!=t.bidderCode&&"33across"!=t.bidderCode||(D.logger.log("wPbjs => apAds_hide now fired (bidder: "+t.bidderCode+")"),e.document.dispatchEvent(e.apAdsHide),D.logger.log("wPbjs => option remove code (bidder: "+t.bidderCode+")"),"gumgum"==t.bidderCode&&(e.pWindow.document.querySelector("head").appendChild(e.pWindow.document.createElement("script")).innerHTML=`setTimeout(function() {for(let i of window.document.querySelectorAll('[id^=ad_is]')) {try{i.remove();} catch(e) {console.log('error removing apAds ad (gumgum):');}}},${o.gumgumRemovalTime})`),"33across"==t.bidderCode&&(e.pWindow.document.querySelector("head").appendChild(e.pWindow.document.createElement("script")).innerHTML=`setTimeout(function() {for(let i of window.document.querySelectorAll('[class^="ttx"],[id^="tynt"]')) {try{i.remove();} catch(e) {console.log('error removing apAds ad (33across):');}}},${o.gumgumRemovalTime})`));let d=l.find((e=>e.code===t.adUnitCode));if(!d)return void D.logger.log(`wPbjs (${y}) >>> error: ad unit not found`,t.adUnitCode);"undertone"==t.bidderCode&&(D.logger.log("wPbjs => apAds now fired (bidder: "+t.bidderCode+")"),e.document.dispatchEvent(e.apAds),n[t.bidderCode].hideAd&&(D.logger.log("wPbjs => apAds_hide now fired (bidder: "+t.bidderCode+")"),e.document.dispatchEvent(e.apAdsHide)),n[t.bidderCode].removeX&&(D.logger.log("wPbjs => apAds_x now fired (bidder: "+t.bidderCode+")"),e.document.dispatchEvent(e.apAdsX)),n[t.bidderCode].removeCode&&(D.logger.log("wPbjs => option remove code (bidder: "+t.bidderCode+")"),e.pWindow.document.querySelector("head").appendChild(e.pWindow.document.createElement("script")).innerHTML=`setTimeout(function() {try{window.document.querySelector('.ut_container').remove();} catch(e) {console.log('error removing apAds ad:');}},${o.gumgumRemovalTime})`),i[t.bidderCode]&&!d.sizes.some((e=>e[0]===t.width&&e[1]===t.height))&&n[t.bidderCode].inlineHeight&&(D.logger.log("wPbjs => apAds_line now fired (bidder: "+t.bidderCode+")"),e.document.dispatchEvent(e.apAdsLine)));let s=!1;if("teads"==t.bidderCode&&i.teads&&n.teads.apAdsDiv&&(1===t.width&&1===t.height||!d.sizes.some((e=>e[0]===t.width&&e[1]===t.height)))){D.logger.log("wPbjs => apAds_div now fired (bidder: "+t.bidderCode+")"),e.document.dispatchEvent(e.apAds),s=!0;let n=new CustomEvent("apAds_div",{detail:t.adUnitCode});e.document.dispatchEvent(n)}["justpremium","sublime","teads","triplelift"].indexOf(t.bidderCode)>-1&&i[t.bidderCode]&&!d.sizes.some((e=>e[0]===t.width&&e[1]===t.height))&&(n[t.bidderCode].stopRefresh&&(D.logger.log("wPbjs => apAds now fired (bidder: "+t.bidderCode+")"),s||(e.document.dispatchEvent(e.apAds),s=!0)),n[t.bidderCode].inlineHeight&&(D.logger.log("wPbjs => apAds_line now fired (bidder: "+t.bidderCode+")"),e.document.dispatchEvent(e.apAdsLine)),n[t.bidderCode].removeX&&(D.logger.log("wPbjs => apAds_x now fired (bidder: "+t.bidderCode+")"),e.document.dispatchEvent(e.apAdsX)),n[t.bidderCode].hideAd&&(D.logger.log("wPbjs => apAds_hide now fired (bidder: "+t.bidderCode+")"),e.document.dispatchEvent(e.apAdsHide))),setTimeout(deleteEventBidWon,1e4,r)}catch(e){console.error(e)}},e.pbjs.addAdUnits(o.adUnits),a=!0,M(o)})),b={},!o.skipDFP){let t=[];o.sizeFluid&&t.push("fluid"),(!o.sizeFluid||o.sizeFluid&&!o.sizeFluidOnlyForGAM)&&(t=t.concat(o.sizesAdUnit)),e.googletag.cmd.push((function(){try{d=e.googletag.defineSlot(o.codeAdUnit,t,o.divId).addService(e.googletag.pubads()),e.googletag.pubads().enableSingleRequest(),!0!==o.nearEnabled&&e.googletag.enableServices(),M(o)}catch(e){console.error(e)}}))}setTimeout(G,3500)}(c),c.ortbBidders.length&&!h&&(I++,k=c.ortbBidders,k=k.map((e=>createOrtb[e.bidder](c,e.params||{}))),function(e){if(!(e=e.filter((e=>e.endpoint&&e.body))).length)return N();P=e.length,e.forEach(((e,t)=>{fetch(e.endpoint,{method:"POST",headers:{"Content-Type":"application/json"},mode:e.corsMode,body:JSON.stringify(e.body)}).then((e=>{if(200===e.status)return e.json()})).then((e=>{if(!e)return N();N(e)})).catch((t=>{console.error("error from ortb bidder: ",e.bidder||"",t),N()}))})),setTimeout((()=>{J()}),1500)}(k))}catch(e){console.error(e)}}};const D={logger:{getTitle:()=>"%chb-1.0",styles:{log:"color: white; font-weight: 700; background: #06d8c6; padding: 2px 4px; border-radius: 4px;",error:"color: white; font-weight: 700; background: #fd3c34; padding: 2px 4px; border-radius: 4px;",warn:"color: white; font-weight: 700; background: #ffff99; color: #444; padding: 2px 4px; border-radius: 4px;"},log(){t.debug&&console.log.apply(console,[this.getTitle(),this.styles.log,...arguments])},error(){t.debug&&console.error.apply(console,[this.getTitle(),this.styles.error,...arguments])},warn(){t.debug&&console.warn.apply(console,[this.getTitle(),this.styles.warn,...arguments])}}};function O(e){if("function"==typeof e)try{e.call()}catch(e){D.logger.error("Error processing command:",e.message,e.stack)}else D.logger.error("Command is not a function")}function R(t){let n=e.document.cookie.match(new RegExp("(?:^|; )"+t.replace(/([\.$?*|{}\(\)\[\]\\\/\\+^])/g,"\\$1")+"=([^;]*)"));return n?decodeURIComponent(n[1]):void 0}function $(e,t){t.amazon||(t.amazon=!0,1==e&&q("amazon"),2==e&&(c?X():c=!0))}t.renderOrtbAd=function(t,n){if(B)return;if(B=!0,!z||!z.bid)return;let i=e.document.createElement("iframe");i.setAttribute("frameborder",0),i.setAttribute("scrolling","no"),i.setAttribute("marginheight","0"),i.setAttribute("marginwidth","0"),i.setAttribute("hspace","0"),i.setAttribute("vspace","0"),i.setAttribute("topmargin",0),i.setAttribute("leftmargin",0),i.setAttribute("allowtransparency",!0),i.setAttribute("border","0px"),i.setAttribute("width",z.bid.w),i.setAttribute("height",z.bid.w),i.style.width=z.bid.w+"px",i.style.height=z.bid.h+"px";try{t.body.appendChild(i)}catch(e){return void console.error("failed to append ortb frame, ",e)}let o=i.contentDocument;o?(o.open(),o.write(z.bid.adm),o.close(),t.defaultView.frameElement.width=z.bid.w||300,t.defaultView.frameElement.height=z.bid.h||250):console.warn("failed to get frameDocument for ortb iframe")},t.renderAd=function(e,t){if(!j||!j.id)return;D.logger.log(`wPbjs => (${y})renderAd - fakeAd nmAd.id=${j.id}`),e.defaultView.frameElement.width=j.size[0]||300,e.defaultView.frameElement.height=j.size[1]||250;let n=j.url||`https://hb.brainlyads.com/images/${j.img}`,i=e.createElement("img");i.src=n,i.style.padding="0px",i.style.margin="0px",i.style.border="0px",e.body.appendChild(i)},t.cmd.push=O,t.cmd.forEach((e=>{O(e)}));let F=[];function N(e){W||(e&&F.push(e),++U>=P&&function(){if(W)return J();if(W=!0,!F.length)return J();let e,t=0;F.forEach(((n,i)=>{n.seatbid.forEach(((n,i)=>{n.bid.forEach(((n,i)=>{n.price>t&&(e=n,t=n.price)}))}))})),e&&t&&(z={cpm:t,bid:e,size:[e.w||300,e.h||250]});J()}())}function J(){if(_)return;_=!0;let t={};if(!(z&&z.cpm&&z.bid))return q("openrtb");t={ortb_pb:z.cpm.toFixed(2),ortb_bidder:z.bidder||"unknown",ortb_size:(z.size||[300,250]).join("x"),auction_id:r},e.googletag.cmd.push((()=>{Object.entries(t).forEach((e=>{d.setTargeting(e[0],e[1])}))})),q("openrtb")}function M(t){(t.skipDFP||d&&a)&&e.pbjs.que.push((function(){e.pbjs.requestBids({auctionId:r,adUnitCodes:t.adUnits.map((e=>e.code)),bidsBackHandler:G,timeout:t.prebidBidTimeout})}))}function G(){D.logger.log(`wPbjs => (${y}) >>> func initAdserver - satrt, pbjs.initAdserverSet =`,s.pbjs),s.pbjs||(e.endAuctionTime=Date.now(),e.eventBus.registerEndAuction(e.pbjsAuctionId),s.pbjs=!0,h?function(){D.logger.log(`wPbjs => (${y}) >>> initAdserverBannerSkipGAM`),e.googletag.cmd&&e.googletag.cmd[0]&&e.googletag.cmd[0]();let t=new CustomEvent("slotRenderEnded");t.isEmpty=!0,e.pbjs.que.push((function(){let n=Y(H()),i=n.adUnitCode;if(D.logger.log("wPbjs => func initAdserver - selectWin, winAdUnitCode =",i),n.isWin){t.isEmpty=!1,t.size=e.adUnitSize;let n=e.pbjs.getAdserverTargetingForAdUnitCode(i);D.logger.log("wPbjs => func initAdserver - getAdserverTargetingForAdUnitCode, winTargetData =",n),n=JSON.parse(JSON.stringify(n)),b[i]=n,b[i].rendered=!1,e.dataPbjsWin={},e.dataPbjsWin[i]=n;let o=new Event("setTargeting");e.document.dispatchEvent(o),q("prebid - skipDFP")}e.googletag.pubads().dispatchEvent(t)}))}():(D.logger.log(`wPbjs => (${y}) >>> initAdserverBannerGAM`),e.googletag.cmd.push((function(){e.pbjs.que.push((function(){let e=Y(H()),t=e.adUnitCode,n=e.bidData;D.logger.log(`wPbjs => (${y}) winAdUnitCode = ${t}`),v.forEach((e=>{Array.isArray(e)&&e.length>1&&d.setTargeting(String(e[0]),String(e[1]))}));let i="hb_pb";if(e.gamCpm&&!e.isWin&&(d.setTargeting("fp_pb",e.gamCpm.toFixed(2)),d.setTargeting("nm_id",j.id),Q(e.gamCpm)),D.logger.log(`wPbjs => (${y}) >>> winAdUnitCode = ${t}`),e.isWin){D.logger.log(`wPbjs => (${y}) >>> set targetings, winAdUnitCode = ${t}`);let o=n.adserverTargeting;Object.keys(o).forEach((e=>{d.setTargeting(e,o[e])}));let r=o&&parseFloat(o.hb_pb);d.setTargeting("orig_hb_pb",e.maxCpm.toFixed(2)),e.gamCpm&&e.maxCpm<e.gamCpm&&(r=e.gamCpm,d.setTargeting(i,r.toFixed(2)),Q(e.gamCpm)),V({biddingRule:w,cpm:r,divId:y,gptSlot:d,targets:o,winAdUnitCode:t})}else d.setTargeting("hb_pb","0.00"),d.setTargeting("orig_hb_pb","0.00");q("prebid")}))}))))}function V({biddingRule:e,cpm:t,divId:n,gptSlot:i,targets:o,winAdUnitCode:d}){if(Number.isNaN(t)||!(o&&e[o.hb_bidder]&&e[o.hb_bidder].value))return;let r=1==e[o.hb_bidder].type&&e[o.hb_bidder].value||2==e[o.hb_bidder].type&&e[o.hb_bidder].value*t||0;if(!r)return;let s=t+r;s=s.toFixed(2),i.setTargeting(keyHbPb,s),D.logger.log(`wPbjs => (${n}) set targetings, winAdUnitCode = `,d,"hb_bidder=",o.hb_bidder,"hb_pb=",o.hb_pb,"google hb_pb=",s);let a="hb_pb_"+o.hb_bidder;i.getTargeting(a).length&&(i.setTargeting(a,s),D.logger.log(`wPbjs => (${n}) >>> set targetings, winAdUnitCode = `,d,"hb_bidder=",o.hb_bidder,"hb_pb=",o.hb_pb,"google "+a+"=",s))}function q(t){D.logger.log(`wPbjs => (${y}) >>> bidderTypeComplete(${t})`,T+1,I),++T==I&&(e.eventBus.registerStartRenderAd(e.pbjsAuctionId),h?(D.logger.log(`wPbjs => (${y}) >>> skipDFP - run renderAd`),function(){if(D.logger.log(`wPbjs => (${y}) >>> renderAd - start`),!b)return;let t=Object.keys(b);D.logger.log(`wPbjs => (${y}) func renderAd - codes = `,t),t.forEach((t=>{if(b[t].rendered)return;b[t].rendered=!0;let n=e.document.getElementById(y);if(D.logger.log(`wPbjs => (${y}) func renderAd - block = `,n),!n)return;let i=e.document.createElement("iframe");i.id=`google_ads_iframe_${y}_0`,i.setAttribute("frameborder",0),i.setAttribute("scrolling","no"),i.setAttribute("marginheight","0"),i.setAttribute("marginwidth","0"),i.setAttribute("hspace","0"),i.setAttribute("vspace","0"),i.setAttribute("topmargin",0),i.setAttribute("leftmargin",0),i.setAttribute("allowtransparency",!0),i.setAttribute("width",0),i.setAttribute("height",0),i.setAttribute("border","0px"),i.style.border="0",n.appendChild(i);let o=b[t],d=i.contentWindow.document;o&&o.hb_adid&&(D.logger.log(`wPbjs => (${y}) func renderAd - RUN pbjs.renderAd, adServerTargeting = `,o),e.pbjs.renderAd(d,o.hb_adid)),delete b[t]}))}()):e.googletag.cmd.push((()=>{try{e.googletag.pubads().addEventListener("slotRenderEnded",(function(){e.eventBus.registerSlotRenderEnded(e.pbjsAuctionId)})),e.googletag.pubads().addEventListener("slotOnload",(function(){e.eventBus.registerSlotOnload(e.pbjsAuctionId);const t=e.pbjs.eventBidWonFuncs[e.pbjsAuctionId],n=t?t.winBid:null;n&&e.adMetrics.flush(e.pbjsAuctionId,e.pbjsUnit,n)})),e.googletag.pubads().addEventListener("impressionViewable",(function(){e.eventBus.registerImpressionViewable(e.pbjsAuctionId)})),D.logger.log(`wPbjs => (${y}) >>> GPT refresh`,d),e.googletag.pubads().refresh([d])}catch(e){console.error(e)}})))}function H(){return l.map((e=>e.code)).reduce(((t,n)=>{let i=e.pbjs.getBidResponsesForAdUnitCode(n);return i&&(t[n]=i),t}),{})}function L(){D.logger.log(`wPbjs => (${y}) >>> run initAdserver video`);let e=Y(H());E=e.adUnitCode,(!f||f&&c)&&X(),f&&!c&&(c=!0)}function X(){D.logger.log(`wPbjs => (${y}) >>> run video`);let t=E||Object.keys(m)[0],n=v.reduce(((e,t)=>(Array.isArray(t)&&t.length>1&&(e[String(t[0])]=String(t[1])),e)),S),i=pbjs.adServers.dfp.buildVideoUrl({adUnit:l.find((function(e){return e.code==t})),bid:!E&&{}||void 0,params:{iu:m[t],cust_params:n,output:"vast"}});E&&e.pbjs.markWinningBidAsUsed({adUnitCode:E}),D.logger.log(`wPbjs => (${y}) >>> vastURL =`,i);let o=e.document.getElementById(y);o&&e.vastAd&&e.vastAd(i,o)}function Q(e){K({eventName:"gamFloorprice",data:{auctionId:r,bidder:"gam",unitId:C&&C[Object.keys(C)[0]],domain:o,floorprice:parseFloat(e)},host:window.top&&window.top.location&&window.top.location.host||"",timestamp:Date.now()})}function K(t){var n;e.pbjs._nextMillenniumStatistic?e.pbjs._nextMillenniumStatistic.add(t):(n=[t],fetch("https://report2.hb.brainlyads.com/statistics",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(n)}))}function Y(t){D.logger.log(`wPbjs => (${y}) >>> selectWin`,t);let n=g,i=Object.keys(t),d=[];for(let e=0;e<i.length;e++){let n=getAdUnitSize(l.find((t=>t.code===i[e]))),o=0;d.push({winAdUnitCode:"",winAdUnitData:null});for(let r=0;r<t[i[e]].bids.length;r++)D.logger.log(`wPbjs => (${y}) Response: adUnitCode=`+i[e]+" cpm=$"+t[i[e]].bids[r].cpm+" bidder="+t[i[e]].bids[r].bidder+(n&&" unitSizes="+JSON.stringify(n)||"")+" responseSize=["+t[i[e]].bids[r].width+","+t[i[e]].bids[r].height+"]"),t[i[e]].bids[r].cpm>o&&(d[e].winAdUnitCode=i[e],d[e].winAdUnitData=t[i[e]].bids[r],o=t[i[e]].bids[r].cpm)}D.logger.log(`wPbjs => (${y}) winsAdUnit >>>`,d);let s,a={isWin:!1,adUnitCode:"",bidData:null,maxCpm:0,gamCpm:0},c=n.find((e=>"gam"===e.code));a.gamCpm=c&&c.price||0;for(let e=0;e<d.length;e++)d[e].winAdUnitCode&&d[e].winAdUnitData.cpm>a.maxCpm&&(a.adUnitCode=d[e].winAdUnitCode,a.bidData=d[e].winAdUnitData,a.maxCpm=d[e].winAdUnitData.cpm);if(D.logger.log(`wPbjs => (${y}) response >>>`,a),a.adUnitCode){s=l.find((e=>e.code===a.adUnitCode));let e=n.find((e=>e.code===a.bidData.bidderCode)),t=e&&e.price;if(!t&&"rhythmone"==a.bidData.bidderCode){let e=s.bids.find((e=>"rhythmone"==e.bidder));t=e&&e.params&&e.params.floor||options.defaultFloorRhythmone}(!t||t&&t<=a.bidData.cpm)&&(a.isWin=!0,t&&t>0&&(D.logger.log(`wPbjs => (${y}) floorprice >>>`,t),C.floorprice=t))}if(a.isWin){let t=getAdUnitSize(s);e.adUnitSize=[a.bidData.width,a.bidData.height],D.logger.log(`wPbjs => (${y}) Winner: adUnitCode=`+a.adUnitCode+" cpm=$"+a.bidData.cpm+" bidder="+a.bidData.bidder+" unitSizes="+JSON.stringify(t)+" responseSize=["+a.bidData.width+","+a.bidData.height+"]"),p=a.bidData,K({eventName:"winBid",data:{auctionId:r,bidder:p.bidder,unitId:C&&C[Object.keys(C)[0]],domain:o,refresh:C.keyValueRefresh,floorprice:C.unitRule[p.bidder]||void 0},host:window.top&&window.top.location&&window.top.location.host||"",timestamp:Date.now()})}var p;return a}function Z(t){let n=Object.keys(t);if(!t||n.length)return null;let i={};for(let e=0;e<n.length;e++)i[n[e]]={bidCpmAdjustment:function(i,o){return i*t[n[e]]}};e.pbjs.bidderSettings=i}function ee(e,t){try{D.logger.log("event bidWon: info",t),e.pWindow.paGlobal||(e.pWindow.paGlobal={}),e.pWindow.paGlobal.data||(e.pWindow.paGlobal.data={}),e.pWindow.paGlobal.data[t.paId]||(e.pWindow.paGlobal.data[t.paId]={}),e.pWindow.paGlobal.data[t.paId].winningBid=copySafe(t),function(e,t,n){t=`hb:${t}`;try{e.tWindow.postMessage(JSON.stringify({event:t,payload:n}),"*")}catch(e){console.error(e)}}(e,"bidWon",t)}catch(e){console.error(e)}}function te(e,t,n,i={}){return{paId:e,unitId:t,divId:n,bidderCode:i.bidderCode,mediaType:i.mediaType,adDomain:i.adserverTargeting?i.adserverTargeting.hb_adomain:""}}}function loadJSScripts(e,t){console.log("loadJSScripts!!!!!");let n=[];const i={src:"https://hb.brainlyads.com/prebid.nm.1.0.js",async:!0};n.push({src:"https://js-sec.indexww.com/ht/p/188333-91751857837145.js",async:!0});let o=[i],d=!1,r=()=>{d||(d=!0,_loadJSScripts(e,o))};e.PWT.jsLoaded=r;let s=e.location.href,a="";if(s.indexOf("pwtv=")>0){let e=/pwtv=(.*?)(&|$)/g.exec(s);e.length>=2&&e[1].length>0&&(a=`/${e[1]}`)}n.push({src:`//ads.pubmatic.com/AdServer/js/pwt/157577/2378${a}/pwt.js`,async:!0}),_loadJSScripts(e,n,t),setTimeout(r,100)}function _loadJSScripts(e,t,n){if(!Array.isArray(t))return;let i=e.document.getElementsByTagName("script")[0],o=0;t.forEach((d=>{let r=e.document.createElement("script");r.async=!!d.async,r.type="text/javascript",r.src=d.src,"function"==typeof n&&(r.onload=function(){++o==t.length&&n()});try{i.parentNode.insertBefore(r,i)}catch(e){console.error(e)}}))}function deleteEventBidWon(e){window.pbjs.eventBidWonFuncs[e]&&delete window.pbjs.eventBidWonFuncs[e]}function cleanerAdUnitExpire(){const e=Date.now();Object.keys(window.pbjs.adUnitExpire).forEach((t=>{e>window.pbjs.adUnitExpire[t]&&(delete window.pbjs.adUnitExpire[t],window.pbjs.que.push((()=>{window.pbjs.analyticAdapterOptions.data[t]&&(Object.keys(window.pbjs.analyticAdapterOptions.data[t]).forEach((e=>{window.pbjs.removeAdUnit(e)})),delete window.pbjs.analyticAdapterOptions.data[t])})),window.eventBus&&window.eventBus.cleanAuction(t)),window.pbjs.eventBidWonFuncs[t]&&e>window.pbjs.eventBidWonFuncs[t].expire&&delete window.pbjs.eventBidWonFuncs[t]})),setTimeout(cleanerAdUnitExpire,6e4)}function createEventBus(){const e={startWrapper:"startWrapper",startAuction:"startAuction",endAuction:"endAuction",startRenderAd:"startRenderAd",endRenderAd:"endRenderAd",slotRenderEnded:"slotRenderEnded",slotOnload:"slotOnload",impressionViewable:"impressionViewable"},t={auctions:{}};let n={event:""};const i={debug:!1},o={events:t,state:n,eventsList:()=>Object.values(e),registerStartWrapper:function(){var n;t[n=e.startWrapper]=r(n),s(n),a(t[n]),t[n]},registerStartAuction:function(t){d(e.startAuction,t)},registerEndAuction:function(t){d(e.endAuction,t)},registerStartRenderAd:function(t){d(e.startRenderAd,t)},registerEndRenderAd:function(t){d(e.endRenderAd,t)},registerSlotRenderEnded:function(t){d(e.slotRenderEnded,t)},registerSlotOnload:function(t){d(e.slotOnload,t)},registerImpressionViewable:function(t){d(e.impressionViewable,t)},cleanAuction:function(e){delete t.auctions[e]},getStartWrapper:()=>t[e.startWrapper]||null,getStartAuction:t=>o.getAuctionEvent(t,e.startAuction),getEndAuction:t=>o.getAuctionEvent(t,e.endAuction),getStartRenderAd:t=>o.getAuctionEvent(t,e.startRenderAd),getEndRenderAd:t=>o.getAuctionEvent(t,e.endRenderAd),getSlotRenderEnded:t=>o.getAuctionEvent(t,e.slotRenderEnded),getSlotOnload:t=>o.getAuctionEvent(t,e.slotOnload),getImpressionViewable:t=>o.getAuctionEvent(t,e.impressionViewable),getAuctionEvent(e,n){const i=t.auctions[e];return i&&i[n]?i[n]:null},setDebug(e){i.debug=e}};return o;function d(e,n){return t.auctions[n]||(t.auctions[n]={}),t.auctions[n][e]=r(e),s(e),a(t.auctions[n][e]),t.auctions[n][e]}function r(e,t){const n={name:e,timestamp:Date.now(),performanceTime:performance?performance.now():null};return t&&(n.auctionId=t),n}function s(e){n.event=e}function a(e){if(!0===i.debug){const t=[e.auctionId?e.auctionId+":"+e.name:e.name,"Timestamp: "+e.timestamp,"PerfomanceTime: "+e.performanceTime];utils.logger.log(t.join("; "))}}}function createMetrics(e,t){const n={flush:function(e,t,i){try{const o={name:t&&t.name,domain:t&&t.domain,bidder:i&&i.bidderCode,metrics:n.calculate(e)};return n.send(o)}catch(e){console.error(e)}},calculate:function(e){const n={auctionInit:i(e),auctionHolding:o(e),renderAd:d(e),slotRenderEnded:r(e),slotOnload:s(e),prebidStartDuration:t.startAuctionTime-t.startTime,auctionDuration:t.endAuctionTime-t.startAuctionTime,renderAdDuration:t.renderAdTime-t.endAuctionTime};return Object.keys(n).forEach((e=>{null===n[e]&&delete n[e]})),n},send(e){fetch("https://hb.brainlyads.com/metrics",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)})}};return n;function i(t){return a(e.getStartWrapper(),e.getStartAuction(t))}function o(t){return a(e.getStartAuction(t),e.getEndAuction(t))}function d(t){return a(e.getStartRenderAd(t),e.getEndRenderAd(t))}function r(t){return a(e.getStartRenderAd(t),e.getSlotRenderEnded(t))}function s(t){return a(e.getStartRenderAd(t),e.getSlotOnload(t))}function a(e,t){let n=null;return e&&t?(n=e.hasOwnProperty("performanceTime")&&t.hasOwnProperty("performanceTime")?t.performanceTime-e.performanceTime:t.timestamp-e.timestamp,n=n>0?n:Math.abs(n),n=Math.round(n),n):n}}function getTopWindow(e,t=0){if(t>10)return e;try{return e.parent.document,getTopWindow(e.parent.window,++t)}catch(t){return e}}function JSONParseSafe(e){try{return JSON.parse(e)}catch(e){return console.error(e),null}}function uuidv4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}function copySafe(e){try{return JSON.parse(JSON.stringify(e))}catch(e){return console.error(e),null}}function getAdUnitSize(e){return e&&e.mediaTypes?e.mediaTypes.banner?e.mediaTypes.banner.sizes:e.mediaTypes.video?e.mediaTypes.video.playerSize:"":""}window.PWT=window.PWT||{},window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],window.pbjs=window.pbjs||{},window.pbjs.que=window.pbjs.que||[],window.pbjs.analyticAdapterOptions={version:"1.0",data:{},auctions:{}},window.pbjs.adUnitExpire={},window.pbjs.eventBidWonFuncs={},window.pbjs.que.push((function(){window.pbjs.enableAnalytics([{provider:"nextMillennium",options:window.pbjs.analyticAdapterOptions}]),window.pbjs.onEvent("bidWon",(function(e){window.pbjs.eventBidWonFuncs[e.auctionId]&&window.pbjs.eventBidWonFuncs[e.auctionId].func(e)}))})),cleanerAdUnitExpire(),expiryStorage.garbageCollector("hb_");
